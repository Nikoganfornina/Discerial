package org.example.discerial.Controladores;

import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.image.ImageView;
import javafx.scene.layout.Pane;
import javafx.scene.shape.Rectangle;
import javafx.stage.Stage;
import org.example.discerial.Util.SessionManager;

import java.io.IOException;

import static org.example.discerial.Util.SessionManager.switchScene;

public class CategoriasJuegoController {

    @FXML private Pane imagenHistoriacategorias;
    @FXML private Pane imagenLiteraturacategorias;
    @FXML private Pane imagenFilosofiacategorias;
    @FXML private Pane imagenBiologiacategorias;
    @FXML private Pane imagenMixtacategorias;


    @FXML
    public void initialize() {
        // Puedes añadir efectos hover o cursores aquí
        aplicarClipRedondeado(imagenHistoriacategorias, 400, 250, 30);
        aplicarClipRedondeado(imagenFilosofiacategorias, 400, 250, 30);
        aplicarClipRedondeado(imagenBiologiacategorias, 400, 250, 30);
        aplicarClipRedondeado(imagenLiteraturacategorias, 400, 250, 30);
        aplicarClipRedondeado(imagenMixtacategorias, 300, 566, 30);

        // Establecer las imágenes
        imagenHistoriacategorias.setImage(new javafx.scene.image.Image("Images/CategoryImages/Historia.jpg"));
        imagenFilosofiacategorias.setImage(new javafx.scene.image.Image("Images/CategoryImages/Filosofia.jpg"));
        imagenBiologiacategorias.setImage(new javafx.scene.image.Image("Images/CategoryImages/Biologia.jpg"));
        imagenLiteraturacategorias.setImage(new javafx.scene.image.Image("Images/CategoryImages/Literatura.jpg"));
        imagenMixtacategorias.setImage(new javafx.scene.image.Image("Images/CategoryImages/Mix.jpg"));
    }
    @FXML
    public void volverTabula() throws IOException {
        switchScene("/org/example/discerial/Tabula_view.fxml");
    }

    private void aplicarClipRedondeado(ImageView imageView, double width, double height, double arc) {
        Rectangle clip = new Rectangle(width, height);
        clip.setArcWidth(arc);
        clip.setArcHeight(arc);
        imageView.setClip(clip);
    }


    private void openGameWithCategory(int categoria_id) {
        try {
            FXMLLoader loader = new FXMLLoader(
                    getClass().getResource("/org/example/discerial/VistaGameController.fxml")
            );
            Parent root = loader.load();

            // Obtén el controlador del juego y pásale la categoría
            GameController gc = loader.getController();
            gc.initData(categoria_id);

            // Crea una nueva Stage o reutiliza la actual
            Stage stage = (Stage) imagenHistoriacategorias.getScene().getWindow();
            stage.getScene().setRoot(root);
            stage.setTitle("Categoria: " + categoria_id);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }



    @FXML private void onHistoriaClicked()     { openGameWithCategory(1); }
    @FXML private void onLiteraturaClicked()   { openGameWithCategory(2); }
    @FXML private void onFilosofiaClicked()    { openGameWithCategory(3); }
    @FXML private void onBiologiaClicked()     { openGameWithCategory(4); }
    @FXML private void onMixtaClicked()        { openGameWithCategory(5); }
}
